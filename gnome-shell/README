Copied from Nixpkgs @ 63c3a29ca82437c87573e4c6919b09a24ea61b0f
